# 邮件服务配置说明

## 概述

本系统使用 Resend 作为邮件服务提供商，在订单状态变更时自动发送邮件通知给用户。

## 配置步骤

### 1. 注册 Resend 账户

1. 访问 [Resend 官网](https://resend.com)
2. 注册账户并验证邮箱
3. 获取 API Key

### 2. 配置环境变量

在项目根目录创建 `.env.local` 文件，添加以下配置：

```env
# Resend 邮件服务配置
RESEND_API_KEY="re_your_api_key_here"

# 应用配置
NEXT_PUBLIC_APP_URL="http://localhost:3000"
```

### 3. 验证域名（可选）

为了使用自定义发件人地址，建议在 Resend 中验证您的域名：

1. 在 Resend 控制台中添加域名
2. 按照提示配置 DNS 记录
3. 验证成功后，可以修改邮件服务中的发件人地址

## 邮件触发时机

系统会在以下订单状态变更时自动发送邮件：

| 状态 | 邮件标题 | 触发时机 |
|------|----------|----------|
| PENDING | 您的租车订单已成功提交 ✅ | 用户提交订单后立即 |
| CONFIRMED | 商家已确认您的租车订单 🚗 | 管理后台确认后 |
| CANCELLED | 很抱歉，您的租车订单被取消 ❌ | 管理后台点击取消或用户主动取消 |
| ONGOING | 订单开始，祝您旅途愉快 🌟 | 到达租车开始时间 |
| COMPLETED | 订单已完成，感谢您的使用 🙏 | 订单结束时间到达 |
| REFUNDED | 退款已处理成功 💰 | 管理后台确认退款 |

## 邮件内容

每封邮件包含以下信息：

- 用户姓名
- 订单编号
- 车型/套餐名称
- 取车时间和还车时间
- 门店信息
- 订单详情链接

## 故障排除

### 邮件发送失败

1. 检查 `RESEND_API_KEY` 是否正确配置
2. 确认网络连接正常
3. 查看控制台错误日志

### 邮件内容问题

1. 检查 `NEXT_PUBLIC_APP_URL` 是否正确配置
2. 确认订单数据完整性
3. 验证用户邮箱地址格式

## 开发测试

在开发环境中，可以使用 Resend 的测试模式：

1. 使用测试 API Key
2. 发送到测试邮箱地址
3. 在 Resend 控制台查看发送记录

## 生产部署

在生产环境中：

1. 使用生产环境的 API Key
2. 配置正确的应用 URL
3. 验证域名以确保邮件送达率
4. 监控邮件发送状态和错误日志
